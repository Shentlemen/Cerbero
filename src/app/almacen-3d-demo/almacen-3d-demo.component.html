<div class="demo-container">
  <!-- Indicador de carga -->
  <div *ngIf="loading" class="loading-overlay">
    <div class="spinner-border text-primary" role="status">
      <span class="visually-hidden">Cargando stock...</span>
    </div>
    <p class="mt-2">Cargando datos del almacén...</p>
  </div>

  <div class="content-wrapper">
    <!-- Componente 3D -->
    <app-almacen-3d
      [almacenId]="'ALM03'"
      [estanteriaId]="'A1'"
      [niveles]="3"
      [cajasporNivel]="4"
      [stockData]="stockData3D"
      (cajaSeleccionada)="onCajaSeleccionada($event)">
    </app-almacen-3d>
  </div>

  <!-- Modal de detalle de caja -->
  <div *ngIf="mostrarModal" class="modal-overlay" (click)="cerrarModal()">
    <div class="modal-content" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h3>
          <i class="fas fa-box-open"></i>
          Caja {{ cajaSeleccionada?.estanteria }} - Nivel {{ cajaSeleccionada?.nivel }} - Posición {{ cajaSeleccionada?.posicion }}
        </h3>
        <button class="close-btn" (click)="cerrarModal()">
          <i class="fas fa-times"></i>
        </button>
      </div>
      
      <div class="modal-body">
        <div *ngIf="tieneContenido(); else sinContenido">
          <h4>Contenido de la caja:</h4>
          <div class="items-list">
            <div *ngFor="let item of cajaSeleccionada?.contenido || []" class="item-card">
              <div class="item-info">
                <span class="item-tipo" [ngClass]="item.tipo.toLowerCase()">{{ item.tipo }}</span>
                <span class="item-nombre">{{ item.nombre }}</span>
                <span class="item-cantidad">x{{ item.cantidad }}</span>
              </div>
              <div class="item-actions">
                <button class="btn-action transferir" (click)="transferirItem(item)" *ngIf="item.tipo === 'PC'">
                  <i class="fas fa-exchange-alt"></i> Transferir
                </button>
                <button class="btn-action quitar" (click)="quitarItem(item)">
                  <i class="fas fa-minus"></i> Quitar
                </button>
              </div>
            </div>
          </div>
        </div>
        
        <ng-template #sinContenido>
          <div class="empty-box">
            <i class="fas fa-box fa-3x"></i>
            <p>Esta caja está vacía</p>
          </div>
        </ng-template>
      </div>
      
      <div class="modal-footer">
        <button class="btn-agregar" (click)="agregarItem()">
          <i class="fas fa-plus"></i> Agregar Item
        </button>
        <button class="btn-cerrar" (click)="cerrarModal()">
          Cerrar
        </button>
      </div>
    </div>
  </div>
</div>

